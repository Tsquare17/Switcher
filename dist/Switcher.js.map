{"version":3,"file":"Switcher.js","sources":["../src/Switcher.js"],"sourcesContent":["export default class Switcher {\n    #className = 'XhrSwitcher';\n\n    constructor(containerSelector, linkSelector, debugging = false) {\n        this.containerSelector = containerSelector;\n        this.linkSelector = linkSelector;\n        this.debugging = debugging;\n    }\n\n    init() {\n        this.container = this.#getElement(this.containerSelector);\n\n        document.querySelector('body').addEventListener('click', e => {\n            if (e.target.matches(this.linkSelector)) {\n                e.preventDefault();\n                this.#replaceEvent(e);\n            }\n        });\n\n        this.#getElement(this.linkSelector);\n    }\n\n    #replaceEvent(event) {\n        let xhr = new XMLHttpRequest();\n        xhr.onreadystatechange = () => {\n            if (xhr.readyState === XMLHttpRequest.DONE) {\n                const doc = this.#getResponseHtml(xhr);\n                const newContent = doc.querySelector(this.containerSelector).innerHTML;\n                const beforeSwitch = new CustomEvent('switcher.before', {\n                    detail: {\n                        event: event,\n                        content: newContent\n                    }\n                });\n\n                event.target.dispatchEvent(beforeSwitch);\n\n                this.container.innerHTML = doc.querySelector(this.containerSelector).innerHTML;\n\n                Switcher.#updateURL(event.target);\n\n                const afterSwitch = new CustomEvent('switcher.after');\n                event.target.dispatchEvent(afterSwitch);\n            }\n        };\n\n        xhr.open('GET', event.target, true);\n        xhr.send();\n    }\n\n    #getResponseHtml(response) {\n        const parser = new DOMParser();\n        return parser.parseFromString(response.responseText, 'text/html');\n    }\n\n    static #updateURL(location) {\n        window.history.pushState(null, '', location);\n    }\n\n    #getElement(selector) {\n        let el = document.querySelector(selector);\n\n        if (el === null && this.debugging) {\n            console.log(this.#className + ': No elements matching ' + selector + ' were found');\n        }\n\n        return el;\n    }\n}\n"],"names":["Switcher","containerSelector","linkSelector","debugging","container","this","document","querySelector","addEventListener","e","target","matches","_this","preventDefault","event","xhr","XMLHttpRequest","onreadystatechange","readyState","DONE","doc","_this2","newContent","innerHTML","beforeSwitch","CustomEvent","detail","content","dispatchEvent","afterSwitch","open","send","response","DOMParser","parseFromString","responseText","location","window","history","pushState","selector","el","console","log","_classPrivateFieldGet"],"mappings":"i+BAAqBA,wBAGLC,EAAmBC,OAAcC,8HAFhC,qBAGJF,kBAAoBA,OACpBC,aAAeA,OACfC,UAAYA,6CAGrB,2BACSC,YAAYC,eAAAA,KAAiBA,KAAKJ,mBAEvCK,SAASC,cAAc,QAAQC,iBAAiB,SAAS,SAAAC,GACjDA,EAAEC,OAAOC,QAAQC,EAAKV,gBACtBO,EAAEI,mBACFD,YAAAA,EAAmBH,6BAIVJ,KAAKH,8DAGZY,cACNC,EAAM,IAAIC,eACdD,EAAIE,mBAAqB,cACjBF,EAAIG,aAAeF,eAAeG,KAAM,KAClCC,IAAMC,YAAAA,EAAsBN,GAC5BO,EAAaF,EAAIb,cAAcc,EAAKpB,mBAAmBsB,UACvDC,EAAe,IAAIC,YAAY,kBAAmB,CACpDC,OAAQ,CACJZ,MAAOA,EACPa,QAASL,KAIjBR,EAAMJ,OAAOkB,cAAcJ,GAE3BH,EAAKjB,UAAUmB,UAAYH,EAAIb,cAAcc,EAAKpB,mBAAmBsB,YAErEvB,EAvCKA,UAuCLA,EAAoBc,EAAMJ,YAEpBmB,EAAc,IAAIJ,YAAY,kBACpCX,EAAMJ,OAAOkB,cAAcC,KAInCd,EAAIe,KAAK,MAAOhB,EAAMJ,QAAQ,GAC9BK,EAAIgB,kBAGSC,UACE,IAAIC,WACLC,gBAAgBF,EAASG,aAAc,wBAGvCC,GACdC,OAAOC,QAAQC,UAAU,KAAM,GAAIH,cAG3BI,OACJC,EAAKnC,SAASC,cAAciC,UAErB,OAAPC,GAAepC,KAAKF,WACpBuC,QAAQC,IAAIC,UAAkB,0BAA4BJ,EAAW,eAGlEC"}